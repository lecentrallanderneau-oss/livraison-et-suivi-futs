<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <!-- Important pour iPhone (safe areas, PWA‚Ä¶) -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <title>{% block title %}F√ªts{% endblock %}</title>

  <!-- Ic√¥nes iPhone -->
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='icons/apple-touch-icon.png') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='icons/favicon-32.png') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='icons/favicon-16.png') }}">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

  <style>
    /* Base desktop ‚Äî inchang√©e */
    html { -webkit-text-size-adjust: 100%; } /* √©vite le ‚Äúgrossissement‚Äù impr√©visible sur iOS */
    body{ padding-bottom:72px; }
    .sticky-bottom-bar{ position:fixed; bottom:0; left:0; right:0; background:#fff; border-top:1px solid #eee; padding:8px; }
    .btn-lg{ padding:14px 18px; font-size:1.05rem; }

    /* ===== Mobile (iPhone) ‚Äî affiner sans casser le desktop ===== */
    @media (max-width: 576px) {
      /* Typo globale plus fine mais champs √† 16px pour √©viter le zoom iOS */
      html { font-size: 15px; }
      body { padding-bottom: 64px; }

      /* Navigation compacte */
      .navbar .navbar-brand { font-size: 1.05rem; }
      .navbar .btn { padding: 6px 10px; font-size: .95rem; }

      /* Titres compacts */
      h5 { font-size: 1.05rem; margin-bottom: .5rem; }
      h6 { font-size: .95rem; }

      /* Listes d‚Äôaccueil : empiler nom + badges pour la lisibilit√© */
      .list-group-item .d-flex.justify-content-between {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: .25rem;
      }
      .list-group-item { padding: .6rem .75rem; }
      .badge { font-size: .75rem; }
      .small { font-size: .8rem; }

      /* Tables plus denses */
      .table { font-size: .9rem; }
      .table td, .table th { padding: .35rem .5rem; }

      /* Formulaires : garder 16px pour emp√™cher le zoom iOS */
      .form-control, .form-select { font-size: 16px; }
      .form-control-lg, .form-select-lg { font-size: 16px; padding: .55rem .75rem; }

      /* Gros boutons mais compacts */
      .btn-lg { padding: .6rem .8rem; font-size: 1rem; }

      /* Barre collante : boutons empil√©s pour les pouces */
      .sticky-bottom-bar .d-flex { flex-direction: column; }
      .sticky-bottom-bar .btn { width: 100%; }

      /* Badges d‚Äô√©quipement en ligne, mais wrap doux */
      .equip-row, .badge-row {
        display: flex; flex-wrap: wrap; gap: .25rem .4rem;
      }
    }

    /* D√©tection iOS : verrouille √† 16px les champs (anti-zoom) */
    @supports (-webkit-touch-callout: none) {
      input, select, textarea { font-size: 16px; }
    }
  </style>
</head>
<body class="bg-light">
  <nav class="navbar bg-white border-bottom mb-3">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="{{ url_for('index') }}">üç∫ F√ªts</a>
      <a class="btn btn-outline-primary" href="{{ url_for('movement_new') }}">+ Livraisons / Reprise</a>
    </div>
  </nav>

  <main class="container">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for cat, msg in messages %}
          <div class="alert alert-{{ 'success' if cat=='message' else cat }} mb-3">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  {# Rappel : on masque d√©j√† la barre sur la fiche client #}
  {% if request.endpoint != 'client_detail' %}
  <div class="sticky-bottom-bar">
    <div class="d-flex gap-2">
      <a class="btn btn-primary flex-fill btn-lg" href="{{ url_for('movement_new') }}">+ Livraisons / Reprise</a>
      <a class="btn btn-outline-secondary flex-fill btn-lg" href="{{ url_for('clients') }}">Clients</a>
    </div>
  </div>
  {% endif %}
</body>
</html>
